{% extends 'todo/base.html' %}

{% block title %}Task List{% endblock %}

{% block content %}
<h1>Task List</h1>

<!-- Filtering and Sorting Section -->
<div style="margin-bottom: 20px; padding: 10px; background-color: #f0f8ff; border: 1px solid #007acc; border-radius: 5px;">
  <form method="get" action="{% url 'task_list' %}" style="display: flex; flex-wrap: wrap; align-items: center; gap: 15px;">
    <div>
      <label for="sort" style="font-weight: bold;">Sort by:</label>
      <select name="sort" id="sort" style="padding: 5px;">
        <option value="due_date" {% if request.GET.sort == 'due_date' %}selected{% endif %}>Due Date</option>
        <option value="status" {% if request.GET.sort == 'status' %}selected{% endif %}>Status</option>
        <option value="priority" {% if request.GET.sort == 'priority' %}selected{% endif %}>Priority</option>
      </select>
    </div>
    <div>
      <label for="status" style="font-weight: bold;">Status:</label>
      <select name="status" id="status" style="padding: 5px;">
        <option value="">-- All --</option>
        <option value="Pending" {% if request.GET.status == 'Pending' %}selected{% endif %}>Pending</option>
        <option value="Completed" {% if request.GET.status == 'Completed' %}selected{% endif %}>Completed</option>
      </select>
    </div>
    <div>
      <label for="priority" style="font-weight: bold;">Priority:</label>
      <select name="priority" id="priority" style="padding: 5px;">
        <option value="">-- All --</option>
        <option value="Low" {% if request.GET.priority == 'Low' %}selected{% endif %}>Low</option>
        <option value="Medium" {% if request.GET.priority == 'Medium' %}selected{% endif %}>Medium</option>
        <option value="High" {% if request.GET.priority == 'High' %}selected{% endif %}>High</option>
      </select>
    </div>
    <div>
      <button type="submit" style="padding: 7px 15px; background-color: #007acc; color: white; border: none; border-radius: 3px; cursor: pointer;">Apply</button>
    </div>
  </form>
</div>

<!-- Task List Section -->
<div style="background-color: #f9f9f9; border: 1px solid #ccc; border-radius: 5px; padding: 15px;">
  <ul style="list-style-type: none; padding: 0;">
    {% for task in tasks %}
      <li style="margin-bottom: 10px; padding: 10px; background-color: #fff; border: 1px solid #ddd; border-radius: 5px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <strong>{{ task.title }}</strong><br>
            <small>
              Due: {{ task.due_date }} | Status: {{ task.status }} | Category: {{ task.category }} | 
              Priority: 
              {% if task.priority == "Low" %}
                <span style="color: green;">{{ task.priority }}</span>
              {% elif task.priority == "Medium" %}
                <span style="color: orange;">{{ task.priority }}</span>
              {% elif task.priority == "High" %}
                <span style="color: red;">{{ task.priority }}</span>
              {% else %}
                {{ task.priority }}
              {% endif %}
            </small>
          </div>
          <div>
            <a href="{% url 'task_update' task.pk %}" style="margin-right: 10px; color: #007acc; text-decoration: none;">Edit</a>
            <a href="{% url 'task_delete' task.pk %}" style="color: #d9534f; text-decoration: none;">Delete</a>
          </div>
        </div>
      </li>
    {% empty %}
      <li>No tasks available. <a href="{% url 'task_create' %}" style="color: #007acc; text-decoration: none;">Add a new task.</a></li>
    {% endfor %}
  </ul>
</div>
{% endblock %}
